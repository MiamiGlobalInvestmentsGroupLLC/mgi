import { NextRequest } from 'next/server'; import { prisma } from '@/lib/prisma'; import bcrypt from 'bcryptjs'; export const runtime='nodejs'; export async function POST(req:NextRequest){ const isAdmin = req.headers.get('cookie')?.includes('admin=1'); if(!isAdmin) return new Response(JSON.stringify({error:'NO_ADMIN'}),{status:401}); const { id, name, email, password } = await req.json(); if(!id||!name||!email||!password) return new Response(JSON.stringify({error:'Missing'}),{status:400}); const hash = await bcrypt.hash(password, 10); await prisma.company.create({ data:{ id, name, email, passwordHash: hash, botName:'Assistant', themePrimary:'#2463eb' } }); return new Response(JSON.stringify({ok:true})); }